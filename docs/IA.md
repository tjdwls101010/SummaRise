# **콘텐츠 요약 및 라이브러리: 정보구조설계(IA)**

이 문서는 '콘텐츠 요약 및 라이브러리' 개인용 웹 애플리케이션의 정보 구조를 정의합니다. 사용자가 웹 콘텐츠를 효율적으로 수집, 요약, 관리할 수 있도록 지원하는 것을 목표로 합니다.

## **1. 내비게이션 구조 (Navigation Structure)**

애플리케이션의 주요 탐색 경로는 \*\*상단 바(Topbar)\*\*와 \*\*사이드바(Sidebar)\*\*의 조합으로 구성됩니다. 이는 넓은 화면에서는 효율적인 정보 접근을, 좁은 화면에서는 공간 활용성을 극대화하는 구조입니다.

### **데스크톱 (Desktop Layout)**

  - **상단 바 (Topbar)**

      - **핵심 기능 영역**: URL을 붙여넣는 메인 입력 필드와 '요약하기' 버튼이 항상 표시됩니다.
      - **글로벌 검색**: 전체 콘텐츠를 대상으로 하는 검색 아이콘/버튼을 배치합니다. 클릭 시 검색 페이지로 이동하거나 모달(Modal) 창을 띄웁니다.

  - **사이드바 (Sidebar)**

      - **로고/앱 이름**: 최상단에 위치하여 홈으로 이동하는 링크 역할을 합니다.
      - **메인 메뉴**:
          - 갤러리 보기 (`/`): 콘텐츠를 시각적인 카드로 보여주는 기본 뷰입니다.
          - 리스트 보기 (`/list`): 콘텐츠를 테이블 형태로 보여주는 상세 정보 중심의 뷰입니다.
          - 검색 (`/search`): 상세 조건으로 검색할 수 있는 전용 검색 페이지입니다.
      - **보조 메뉴**:
          - 설정 (`/settings`): LLM API 키 관리 등 앱 설정을 위한 페이지입니다.

<!-- end list -->

```
+---------------------------------------------------------------------------------+
| Topbar: [ URL 입력 필드                                   ] [요약] [검색 🔍]  |
+--------------------------+------------------------------------------------------+
| Sidebar:                 |                                                      |
| [로고/앱 이름]           |                                                      |
|                          |                                                      |
| --- 보기 ---             |             콘텐츠 표시 영역                           |
| - 갤러리 보기            |            (기본: 갤러리 뷰)                          |
| - 리스트 보기            |                                                      |
| - 검색                   |                                                      |
|                          |                                                      |
| --- 관리 ---             |                                                      |
| - 설정                   |                                                      |
|                          |                                                      |
+--------------------------+------------------------------------------------------+
```

### **모바일 (Mobile Layout)**

  - **상단 바 (Topbar)**

      - **햄버거 메뉴 아이콘 (☰)**: 클릭 시 사이드바 메뉴가 화면 위로 오버레이(Overlay) 또는 슬라이드 형태로 나타납니다.
      - **핵심 기능**: '요약' 또는 '+' 아이콘을 배치하여 URL 입력 및 요약 기능을 바로 실행할 수 있는 모달을 띄웁니다.
      - **검색 아이콘 (🔍)**: 클릭 시 검색 페이지로 이동합니다.

  - **사이드바 (오버레이/슬라이드 메뉴)**

      - 데스크톱 사이드바의 모든 메뉴 항목(갤러리, 리스트, 검색, 설정)을 포함합니다.

-----

## **2. 페이지 계층 구조 (Page Hierarchy)**

페이지들은 기능에 따라 명확한 계층을 가지며, 사용자가 자신의 위치를 쉽게 파악하고 원하는 정보로 빠르게 이동할 수 있도록 설계합니다.

```
/ (홈, 갤러리 뷰)
├── /list (리스트 뷰)
├── /search (검색 페이지)
├── /settings (설정 페이지)
└── /item/[id] (콘텐츠 상세 페이지)
    └── /item/[id]/edit (콘텐츠 편집 페이지)
```

  - **최상위 레벨 (Level 1)**

      - `/` (갤러리 뷰): 애플리케이션의 기본 진입 페이지입니다.
      - `/list` (리스트 뷰): 모든 콘텐츠를 목록 형태로 보여줍니다.
      - `/search` (검색): 필터와 키워드를 사용해 콘텐츠를 검색합니다.
      - `/settings` (설정): API 키 및 기타 앱 설정을 관리합니다.

  - **하위 레벨 (Level 2)**

      - `/item/[id]`: 특정 콘텐츠의 상세 내용을 보여주는 페이지입니다. 갤러리, 리스트, 검색 결과 페이지에서 진입할 수 있습니다.
      - `/item/[id]/edit`: 상세 페이지 내에서 '수정하기' 기능을 실행했을 때 접근하는 페이지로, 원본과 수정본의 차이를 보여주는 diff 뷰를 포함합니다.

-----

## **3. 콘텐츠 조직화 (Content Organization)**

콘텐츠는 '아이템(Item)'이라는 기본 단위로 구성되며, 각 아이템은 명확한 메타데이터 스키마를 가집니다. 이는 검색, 필터링, 정렬의 기반이 됩니다.

### **콘텐츠 스키마 (Supabase Table: `contents`)**

| 필드명 (`Field`)       | 데이터 타입 (`Type`)      | 설명 (`Description`)                                 | 예시 (`Example`)                             |
| ---------------------- | ------------------------- | ---------------------------------------------------- | -------------------------------------------- |
| `id`                   | `uuid` (Primary Key)      | 각 콘텐츠의 고유 식별자                              | `a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6`        |
| `created_at`           | `timestamp with time zone`| 콘텐츠 생성 시각 (기본 정렬 기준)                    | `2025-07-16 23:07:00+09`                     |
| `source_url`           | `text` (Unique)           | 원본 콘텐츠의 URL                                    | `https://www.youtube.com/watch?v=...`        |
| `content_type`         | `enum` ('youtube', 'web') | 콘텐츠 종류 (YouTube 영상 또는 일반 웹페이지)        | `youtube`                                    |
| `title`                | `text`                    | 콘텐츠 제목 (YouTube 제목 또는 웹페이지 `<title>`) | `Next.js 15 새로운 기능 리뷰`                  |
| `channel_or_site`      | `text`                    | 출처 (YouTube 채널명 또는 웹사이트 도메인)           | `Vercel`                                     |
| `original_content`     | `text`                    | 원본 내용 (YouTube 스크립트 또는 Markdown 변환 HTML) | `안녕하세요, 오늘은 Next.js 15의...`         |
| `summarized_content`   | `text`                    | LLM이 요약한 내용 (Markdown 형식)                    | `Next.js 15는 리액트 19를 지원하며...`       |
| `tags`                 | `text[]` (Array)          | 사용자가 추가한 태그 배열                            | `{"Next.js", "React", "Frontend"}`           |

### **콘텐츠 분류 체계 (Taxonomy)**

  - **기본 분류**: `content_type` (`youtube` vs `web`) 필드를 통해 콘텐츠 유형을 명시적으로 구분합니다.
  - **사용자 정의 분류 (Folksonomy)**: `tags` 필드를 통해 사용자가 자유롭게 콘텐츠를 분류하고 그룹화할 수 있습니다. 태그는 검색 및 필터링의 핵심 요소로 활용됩니다.

-----

## **4. 인터랙션 패턴 (Interaction Patterns)**

사용자 경험을 향상시키기 위한 주요 인터랙션 패턴과 플로우를 정의합니다.

### **핵심 플로우: 콘텐츠 추가 및 요약**

1.  **URL 입력**: 사용자가 상단 바의 입력 필드에 URL을 붙여넣고 '요약하기' 버튼을 클릭합니다.
2.  **백그라운드 처리 시작**:
      - UI는 로딩 상태(스피너, 진행률 표시 등)로 전환됩니다.
      - 서버(Next.js API Route)는 URL 유효성을 검사합니다.
3.  **콘텐츠 가져오기**:
      - **YouTube**: YouTube Transcript API를 이용해 스크립트를 추출합니다.
      - **기타 URL**: `fetch`로 HTML을 가져온 후 MarkItDown 라이브러리를 사용해 Markdown으로 변환합니다.
      - *실패 시*: 사용자에게 "콘텐츠를 가져올 수 없습니다"와 같은 명확한 오류 메시지를 표시합니다.
4.  **LLM 요약**:
      - 추출된 텍스트를 설정된 우선순위에 따라 LLM API(기본: Gemini)로 전송하여 요약을 요청합니다.
      - *API 실패 시*: 다음 우선순위의 API로 자동 전환(failover)을 시도합니다. 모든 API 실패 시 사용자에게 오류를 알립니다.
5.  **데이터 저장 및 UI 업데이트**:
      - 요약된 내용과 메타데이터를 Supabase에 저장합니다.
      - 로딩 상태를 종료하고, 새로 추가된 콘텐츠를 갤러리/리스트 뷰의 최상단에 표시하며 시각적 피드백(예: 하이라이트 효과)을 줍니다.

### **기타 주요 인터랙션**

  - **검색 (Search)**:

      - 상단 바 검색 아이콘 클릭 시 `/search` 페이지로 이동합니다.
      - 사용자가 키워드를 입력하면 제목, 원본/요약 내용, 태그에서 실시간으로 검색 결과를 필터링하여 보여줍니다.
      - 날짜 범위, 콘텐츠 타입, 특정 태그를 선택할 수 있는 필터 옵션을 제공합니다.

  - **재요약 (Re-summarize)**:

      - 콘텐츠 상세 페이지 (`/item/[id]`)에서 '재요약' 버튼을 클릭합니다.
      - 다른 LLM 모델을 선택할 수 있는 옵션을 제공할 수 있습니다.
      - 요약이 완료되면 기존 `summarized_content`를 덮어쓰고 사용자에게 성공 피드백을 줍니다.

  - **수정 및 Diff 보기 (Edit with Diff)**:

      - 상세 페이지에서 '수정' 버튼을 클릭하면 편집 모드(`/item/[id]/edit`)로 전환됩니다.
      - 좌측에는 마지막으로 저장된 요약본, 우측에는 사용자가 수정할 수 있는 편집기가 표시됩니다.
      - **Diff 뷰**: 라이브러리(예: `react-diff-viewer`)를 사용하여 두 텍스트 간의 차이점(추가/삭제된 줄)을 시각적으로 보여줍니다.
      - '저장' 시 `summarized_content` 필드가 업데이트됩니다.

-----

## **5. URL 구조 (URL Structure)**

일관되고 예측 가능한 URL 구조는 사용자 경험과 기술적 관리에 용이합니다. Next.js의 App Router를 기반으로 한 직관적인 라우팅을 사용합니다.

  - **기본**: `https://your-app-domain.com`

  - **주요 페이지**:

      - `/`: 갤러리 뷰 (기본 페이지)
      - `/list`: 리스트 뷰
      - `/search`: 검색 페이지
      - `/settings`: 설정 페이지

  - **동적 페이지 (Dynamic Pages)**:

      - `/item/[id]`: 특정 콘텐츠 상세 페이지
          - 예: `/item/a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6`

  - **쿼리 파라미터 (Query Parameters)** - 필터링 및 정렬

      - `/list?sort=created_at&order=desc`: 리스트 뷰에서 생성일 기준 내림차순 정렬
      - `/search?q=Next.js&type=youtube`: 'Next.js'를 포함하는 YouTube 콘텐츠 검색

### **링크 전략 (Linking Strategy)**

  - **내부 링크 (Internal Linking)**:

      - 앱 내 모든 페이지 이동은 Next.js의 `<Link>` 컴포넌트를 사용합니다.
      - 이를 통해 클라이언트 사이드 라우팅을 활성화하여 페이지 새로고침 없이 빠른 화면 전환을 제공합니다.
      - 예: 갤러리 뷰의 콘텐츠 카드를 클릭하면 `<Link href="/item/[id]">`를 통해 상세 페이지로 이동합니다.

  - **외부 링크 (External Linking)**:

      - 콘텐츠의 원본 URL(`source_url`)로 이동하는 링크는 `<a>` 태그를 사용하며, 항상 `target="_blank"`와 `rel="noopener noreferrer"` 속성을 추가합니다.
      - 이는 보안(Tabnabbing 방지)을 강화하고, 사용자가 앱을 떠나지 않고 원본 콘텐츠를 새 탭에서 확인할 수 있게 합니다.

-----

## **6. 컴포넌트 계층 구조 (Component Hierarchy)**

UI를 재사용 가능하고 관리하기 쉬운 컴포넌트 단위로 분해합니다. shadcn/ui의 철학에 따라 조합 가능한(composable) 컴포넌트를 설계합니다.

```
- /app
  ├── layout.tsx (Root Layout)
  │   ├── components/
  │   │   ├── **Global/Layout**
  │   │   │   ├── Topbar.tsx (URL 입력 필드, 검색 버튼)
  │   │   │   └── Sidebar.tsx (내비게이션 메뉴)
  │   │   ├── **UI/Shared** (shadcn/ui 기반 또는 커스텀)
  │   │   │   ├── Button.tsx
  │   │   │   ├── Input.tsx
  │   │   │   ├── Card.tsx
  │   │   │   ├── Table.tsx
  │   │   │   ├── Tag.tsx
  │   │   │   └── Spinner.tsx
  │   │   └── **Content**
  │   │       ├── ContentInputForm.tsx (URL 입력, 요약 요청 로직)
  │   │       ├── ContentCard.tsx (갤러리 뷰의 각 아이템)
  │   │       ├── ContentListItem.tsx (리스트 뷰의 각 행)
  │   │       └── MarkdownRenderer.tsx (요약/원본 콘텐츠 렌더링)
  │   │
  │   ├── (page.tsx) - 갤러리 뷰
  │   │   └── components/GalleryView.tsx (ContentCard들을 렌더링)
  │   │
  │   ├── /list
  │   │   └── page.tsx - 리스트 뷰
  │   │       └── components/ListView.tsx (ContentListItem들을 렌더링)
  │   │
  │   ├── /search
  │   │   └── page.tsx - 검색 페이지
  │   │       └── components/SearchView.tsx (검색 필터, 결과 표시)
  │   │
  │   ├── /settings
  │   │   └── page.tsx - 설정 페이지
  │   │       └── components/SettingsForm.tsx (API 키 관리 UI)
  │   │
  │   └── /item/[id]
  │       ├── page.tsx - 상세 페이지
  │       │   └── components/ItemDetailView.tsx (메타데이터, 재요약/수정 버튼)
  │       └── /edit
  │           └── page.tsx - 편집 페이지
  │               └── components/ItemEditView.tsx (Diff 뷰, 편집기)
  │
  └── lib/ (Supabase 클라이언트, API 헬퍼 함수 등)
```

  - **최상위 레이아웃 (`layout.tsx`)**: `Topbar`와 `Sidebar` 컴포넌트를 포함하여 모든 페이지에 일관된 레이아웃을 제공합니다.
  - **페이지 컴포넌트 (`page.tsx`)**: 각 라우트의 진입점으로, 해당 페이지에 필요한 데이터를 불러오고 하위 뷰 컴포넌트를 렌더링합니다.
  - **뷰 컴포넌트 (`...View.tsx`)**: 특정 페이지의 전체적인 구조와 데이터 표시를 담당합니다. (예: `GalleryView`, `ListView`)
  - **단위 컴포넌트 (`...Card.tsx`, `...Item.tsx`)**: 재사용 가능한 가장 작은 UI 단위입니다. (예: `ContentCard`)
  - **공유 컴포넌트 (`UI/Shared`)**: 버튼, 입력창 등 앱 전반에서 사용되는 기본 UI 요소들입니다. shadcn/ui 컴포넌트를 그대로 사용하거나 필요에 따라 래핑(wrapping)하여 사용합니다.